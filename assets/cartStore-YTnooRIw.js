import{j as d,k as r}from"./index-vmQ5LtDv.js";import{s as o}from"./swalMixin-ro-B760h.js";const m=d("cart",{state:()=>({cartList:[],isLoading:!1,currentLoadingId:"",temp:{couponCode:""},orderInfo:{user:{},message:""}}),actions:{async getCartList(){var s,e;try{const t=await r.get("https://vue3-course-api.hexschool.io/v2/api/yu-api-2/cart");this.cartList=t.data.data}catch(t){o.methods.showToast({title:((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"發生錯誤，請稍後再試",icon:"error"})}},async addToCart(s,e=1){var a,c;this.currentLoadingId=s;const t={product_id:s,qty:e};try{const i=await r.post("https://vue3-course-api.hexschool.io/v2/api/yu-api-2/cart",{data:t});o.methods.showToast({title:i.data.message,icon:"success"})}catch(i){o.methods.showToast({title:((c=(a=i.response)==null?void 0:a.data)==null?void 0:c.message)||"發生錯誤，請稍後再試",icon:"error"})}this.currentLoadingId=""},async putCartItem(s,e,t){var c,i;if(t<=0){const h=this.cartList.carts.findIndex(n=>n.id===s);this.cartList.carts[h].qty=1,o.methods.showToast({title:"請輸入大於 0 的數字",icon:"error"});return}const a={product_id:e,qty:t};try{const h=await r.put(`https://vue3-course-api.hexschool.io/v2/api/yu-api-2/cart/${s}`,{data:a});this.getCartList(),o.methods.showToast({title:h.data.message,icon:"success"})}catch(h){o.methods.showToast({title:((i=(c=h.response)==null?void 0:c.data)==null?void 0:i.message)||"發生錯誤，請稍後再試",icon:"error"})}},async deleteCartItem(s){var e,t;this.currentLoadingId=s;try{const a=await r.delete(`https://vue3-course-api.hexschool.io/v2/api/yu-api-2/cart/${s}`);this.getCartList(),o.methods.showToast({title:a.data.message,icon:"success"})}catch(a){o.methods.showToast({title:((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"發生錯誤，請稍後再試",icon:"error"})}this.currentLoadingId=""},async deleteCartAll(){var s,e;try{const t=await r.delete("https://vue3-course-api.hexschool.io/v2/api/yu-api-2/carts");this.cartList=[],o.methods.showToast({title:t.data.message,icon:"success"})}catch(t){o.methods.showToast({title:((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"發生錯誤，請稍後再試",icon:"error"})}},async postOrder(){var e,t;if(!this.cartList.carts||this.cartList.carts.length<=0){o.methods.showToast({title:"購物車目前沒有商品",icon:"warring"});return}const s=this.orderInfo;try{const a=await r.post("https://vue3-course-api.hexschool.io/v2/api/yu-api-2/order",{data:s});this.cartList=[],this.orderInfo={user:{},message:""},this.temp.couponCode="",o.methods.showToast({title:a.data.message,icon:"success"})}catch(a){o.methods.showToast({title:((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"發生錯誤，請稍後再試",icon:"error"})}},async applyCoupon(s){var e,t;try{const a=await r.post("https://vue3-course-api.hexschool.io/v2/api/yu-api-2/coupon",{data:{code:s}});this.getCartList(),o.methods.showToast({title:a.data.message,icon:"success"})}catch(a){o.methods.showToast({title:((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"發生錯誤，請稍後再試",icon:"error"})}}}});export{m as c};
